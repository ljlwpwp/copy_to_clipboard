<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>constructor-nodelist</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <button id="b" data-clipboard-text="">계좌번호 복사</button>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
    <script>
      var btn = document.querySelector('#b');
      var clipboard = new ClipboardJS(btn);
      var val = getUrlParams().val;
      btn.dataset.clipboardText = val;
      <!-- btn.textContent = val; -->

      clipboard.on('success', function () {
          window.alert('계좌번호가 복사 되었습니다.');
          window.open('', '_self', '');
          window.close();
      });

      try {
          btn.click();
          clipboard.onClick();
      } catch (e) {
      }

      navigator.clipboard.readText()
              .then(text => {

                  if (text === val) {
                      window.alert('계좌번호가 복사 되었습니다.');
                      window.open('', '_self', '');
                      window.close();
                  }
              })
              .catch(err => {
                  console.error('Failed to read clipboard contents: ', err);
              });

      function getUrlParams() {
          var params = {};

          window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,
                  function(str, key, value) {
                      params[key] = value;
                  }
          );

          return params;
      }
    </script>
  </body>
</html>
